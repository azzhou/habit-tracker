{% extends "layout.html" %}
{% block content %}
  <div class="content-section">
    <h4 class="mb-4">Checklist</h4>

    <!-- Checkbox table -->
    <form method="POST" action="">
      {{ new_habit_form.hidden_tag() }}
      <div class="table-responsive container-border mb-5">
        <table class="table">
          <thead>
            <th scope="col"></th>  <!-- Placeholder for blank upper left cell -->
            {% for date in checklist_date_labels %}
              <th scope="col" class="date-label">{{ date }}</th>
            {% endfor %}
          </thead>
          <tbody>
            {% for habit in habits %}
              <tr>
                <th scope="row" class="habit-label">
                  <a href="{{ url_for('habits.habit', slug=habit.slug) }}"
                    class="stretched-link habit-link">
                    {{ habit.name }}
                  </a>
                </th>
                {% for i in range(checklist_date_labels|length) %}
                  <td>
                    <form action="{{ checklist_routes[habit.id][i] }}", method="POST">
                      <label class="checkmark-container">
                        <input type="checkbox"
                              oninput="submit()"
                              {{ 'checked' if checklist_default_values[habit.id][i] else '' }}>
                        <span class="checkmark"></span>
                      </label>
                    </form>
                  </td>
                {% endfor %}
              </tr>
            {% endfor %}
            <tr>
              <th scope="row">
                {% if new_habit_form.name.errors %}
                  {{ new_habit_form.name(class="form-control is-invalid", placeholder="Add New Habit") }}
                  <div class="invalid-feedback">
                    {% for error in new_habit_form.name.errors %}
                      <span>{{ error }}</span>
                    {% endfor %}
                  </div>
                {% else %}
                  {{ new_habit_form.name(class="form-control", placeholder="Add New Habit") }}
                {% endif %}
              </th>
              {% for i in range(checklist_date_labels|length) %}
                <td></td>  <!-- placeholder so the table is full -->
              {% endfor %}
            </tr>
          </tbody>
        </table>
      </div>
    </form>

    <!-- Habit 1-yr history grid -->
    <h4 class="mb-4">History</h4>
    <div class="graph-container container-border mb-5">
      <div class="graph">
        <ul class="months">
          {% for month in grid_month_labels %}
            <li>{{ month }}</li>
          {% endfor %}
        </ul>
        <ul class="days">
          <li>Sun</li>
          <li>Mon</li>
          <li>Tue</li>
          <li>Wed</li>
          <li>Thu</li>
          <li>Fri</li>
          <li>Sat</li>
        </ul>
        <ul class="squares">
          {% for date in grid_date_labels %}
            <li data-level="5">
              <span class="date-tooltip">{{ date }}</span>
            </li>
          {% endfor %}
        </ul>
      </div>
    </div>
    
  </div>
{% endblock content %}